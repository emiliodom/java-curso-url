<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Semana 5 - Rutas y Controladores (Guia Interactiva)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css" rel="stylesheet">
  <link href="https://unpkg.com/tippy.js@6.3.7/dist/tippy.css" rel="stylesheet">
  <link href="styles.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">Sesion 5 — Rutas y Controladores</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="nav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="preparar_pc.html">Preparar proyecto</a></li>
          <li class="nav-item"><a class="nav-link" href="ejercicios.html">Ejercicios</a></li>
          <li class="nav-item"><a class="nav-link" href="cheatsheet.html">Resumen rapido</a></li>
          <li class="nav-item"><a class="nav-link" href="entregable_equipo.html">Entregable</a></li>
        </ul>
      </div>
    </div>
  </nav>
  <header class="hero">
    <div class="container py-5">
      <p class="eyebrow">Semana 5 · Desarrollo web con Spring Boot I</p>
      <h1>Rutas y Controladores paso a paso</h1>
      <p class="lead">Guia interactiva para explicar MVC, imports, dependencias y el flujo completo de guardado. Usa los botones para abrir cada detalle.</p>
      <div class="d-flex gap-2 flex-wrap">
        <a class="btn btn-primary" href="#mapa">Ir al mapa MVC</a>
        <a class="btn btn-outline-light" href="#guia-crud">Guia paso a paso</a>
        <a class="btn btn-outline-light" href="#comparativa">Comparativa CRUD</a>
        <a class="btn btn-outline-light" href="#checklist">Checklist de aprendizaje</a>
        <a class="btn btn-outline-light" href="#diagramas">Diagramas</a>
        <a class="btn btn-outline-light" href="#quiz">Quiz</a>
        <a class="btn btn-outline-light" href="#bolson">El Bolson Spring</a>
      </div>
    </div>
  </header>

  <main>
    <section class="section" id="mapa">
      <div class="container">
        <div class="section-title">
          <h2>Mapa MVC con rutas reales</h2>
          <p>Visualiza el camino completo. Cada paso tiene un proposito didactico.</p>
        </div>
        <div class="mvc-map">
          <div class="mvc-step">
            <span>1</span>
            <h3>Vista</h3>
            <p>El usuario abre una pagina (lista.html o formulario.html).</p>
          </div>
          <div class="mvc-step">
            <span>2</span>
            <h3>Controlador</h3>
            <p>Recibe la ruta y decide que vista mostrar o que guardar.</p>
          </div>
          <div class="mvc-step">
            <span>3</span>
            <h3>Repositorio</h3>
            <p>Gestiona el acceso a datos con Spring Data JPA.</p>
          </div>
          <div class="mvc-step">
            <span>4</span>
            <h3>BD</h3>
            <p>H2 en archivo guarda los registros.</p>
          </div>
        </div>
        <div class="callout">
          <strong>Frase clave:</strong> Ruta -> Controlador -> Vista -> Guardado. Si una pieza falla, se rompe el flujo.
        </div>
      </div>
    </section>

    <section class="section" id="guia-crud">
      <div class="container">
        <div class="section-title">
          <h2>Guia paso a paso del CRUD</h2>
          <p>Ruta clara para construir el flujo completo con evidencias de aprendizaje funcional.</p>
        </div>

        <div class="row g-3">
          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 1 — Definir el recurso</h3>
              <p>Define el recurso que vas a guardar (ej: RecursoDidactico) y sus campos.</p>
              <ul>
                <li>Campos minimos: titulo, tipo, url, disponible.</li>
                <li>Nombre de la tabla y tipo de dato esperado.</li>
              </ul>
              <p class="small"><strong>Evidencia:</strong> una lista de campos con tipo y ejemplo.</p>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 2 — Estructura del proyecto</h3>
              <p>Organiza el codigo para encontrar todo rapido.</p>
              <pre><code class="language-bash">src/main/java/.../
  controlador/
  modelo/
  repositorio/

src/main/resources/
  templates/recursos/
    lista.html
    formulario.html
  static/css/
    estilos.css
  application.properties</code></pre>
              <p class="small"><strong>Criterio de logro:</strong> cada carpeta responde a una tarea.</p>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 3 — Modelo y entidad</h3>
              <p>Crea la entidad con sus getters/setters y constructor vacio.</p>
              <ul>
                <li>@Entity + @Table con nombre claro.</li>
                <li>Campos con tipos correctos (String, Boolean).</li>
              </ul>
              <p class="small"><strong>Evidencia:</strong> la app inicia sin errores de mapeo.</p>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 4 — Repositorio</h3>
              <p>Define la interfaz que conecta con la base de datos.</p>
              <ul>
                <li>Extiende JpaRepository.</li>
                <li>Usa el tipo de entidad y su id.</li>
              </ul>
              <p class="small"><strong>Criterio de logro:</strong> puedes usar save() y findAll().</p>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 5 — Rutas GET</h3>
              <p>Define las rutas que muestran vistas.</p>
              <pre><code class="language-bash">GET  /recursos        -> lista
GET  /recursos/nuevo  -> formulario</code></pre>
              <p class="small"><strong>Evidencia:</strong> ambas rutas cargan sin 404.</p>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 6 — Enviar informacion</h3>
              <p>Conecta el formulario con Thymeleaf y la entidad.</p>
              <ul>
                <li>Usa th:object y th:field.</li>
                <li>Apunta el formulario a la ruta POST.</li>
              </ul>
              <p class="small"><strong>Criterio de logro:</strong> al enviar, el objeto llega completo.</p>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 7 — Guardar en BD</h3>
              <p>En el controlador, usa el repositorio para guardar y redirigir.</p>
              <ul>
                <li>POST /recursos recibe @ModelAttribute.</li>
                <li>repo.save(...) y luego redirect:/recursos.</li>
              </ul>
              <p class="small"><strong>Evidencia:</strong> el registro aparece en la lista.</p>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="info-card">
              <h3>Paso 8 — Mostrar y dar estilo</h3>
              <p>Diseña la lista y aplica estilos para lectura clara.</p>
              <ul>
                <li>Tabla o tarjetas con th:each.</li>
                <li>CSS en static/css/estilos.css.</li>
              </ul>
              <p class="small"><strong>Criterio de logro:</strong> la vista es legible y ordenada.</p>
            </div>
          </div>
        </div>

        <div class="callout mt-4">
          <strong>Estándar funcional:</strong> el estudiante explica el flujo completo sin saltar pasos y puede mostrar evidencia en pantalla.
        </div>
      </div>
    </section>

    <section class="section section-alt" id="comparativa">
      <div class="container">
        <div class="section-title">
          <h2>Guia comparativa del CRUD (Semana 4 reforzada)</h2>
          <p>Comparacion basada en el material de la Semana 4: lo original vs lo que se agrego/mejoro para completar el CRUD.</p>
        </div>

        <div class="row g-3">
          <div class="col-md-6 col-lg-4">
            <div class="info-card">
              <h3>Estructura de carpetas</h3>
              <p>Base del proyecto y donde vive cada pieza.</p>
              <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalEstructura">Ver detalle</button>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="info-card">
              <h3>application.properties</h3>
              <p>Configuracion minima vs extendida para debug.</p>
              <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalProperties">Ver detalle</button>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="info-card">
              <h3>Entidad (Modelo)</h3>
              <p>Por que necesitas constructores y getters/setters.</p>
              <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalEntidad">Ver detalle</button>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="info-card">
              <h3>Repositorio</h3>
              <p>La interfaz que abre la puerta a la BD.</p>
              <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalRepo">Ver detalle</button>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="info-card">
              <h3>Controlador</h3>
              <p>Rutas que muestran y guardan informacion.</p>
              <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalController">Ver detalle</button>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="info-card">
              <h3>Vistas y CSS</h3>
              <p>Lo que el usuario ve y valida.</p>
              <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalVistas">Ver detalle</button>
            </div>
          </div>
        </div>

        <div class="callout mt-4">
          <strong>Idea central:</strong> el material original da el esqueleto; el estudiante debe construir la carne (vistas, rutas completas y detalles).
        </div>
      </div>
    </section>

    <section class="section" id="imports">
      <div class="container">
        <div class="section-title">
          <h2>Imports y dependencias: el por que</h2>
          <p>No se trata de memorizar, sino de entender la necesidad que resuelve cada linea.</p>
        </div>
        <div class="row g-3">
          <div class="col-lg-6">
            <div class="info-card">
              <h3>Dependencias clave</h3>
              <ul>
                <li><strong>spring-boot-starter-web:</strong> rutas, controladores y servidor.</li>
                <li><strong>spring-boot-starter-thymeleaf:</strong> templates HTML (plantillas).</li>
                <li><strong>spring-boot-starter-data-jpa:</strong> acceso a BD con repositorios.</li>
                <li><strong>h2:</strong> base de datos ligera en archivo.</li>
              </ul>
              <p class="small">Si falta una dependencia, la aplicacion compila mal o no renderiza vistas.</p>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="info-card">
              <h3>Imports frecuentes en Controlador</h3>
              <pre><code>import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;</code></pre>
              <p class="small">Cada import corresponde a una tarea: mostrar vistas, agregar datos, y definir rutas.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section section-alt" id="diagramas">
      <div class="container">
        <div class="section-title">
          <h2>Diagramas explicativos</h2>
          <p>Visualiza MVC, rutas, estructura y comparativa con una app moderna.</p>
        </div>

        <div class="diagram-grid">
          <div class="diagram-card">
            <h3>MVC y flujo</h3>
            <pre class="mermaid">flowchart LR
  A[Usuario] --> B[Vista HTML]
  B --> C[Controlador]
  C --> D[Repositorio]
  D --> E[(BD H2)]
  E --> D --> C --> B
            </pre>
            <p class="small-muted">Muestra el recorrido completo de una solicitud y el regreso al usuario.</p>
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalMvc">Ver en pantalla completa</button>
          </div>
          <div class="diagram-card">
            <h3>Imports y dependencias</h3>
            <pre class="mermaid">flowchart TB
  Web[Spring Web] --> Controlador
  Thymeleaf[Thymeleaf] --> Vista
  JPA[Spring Data JPA] --> Repositorio
  H2[BD H2] --> DB[(BD)]
  Controlador --> Vista
  Controlador --> Repositorio
            </pre>
            <p class="small-muted">Cada dependencia habilita una pieza funcional del proyecto.</p>
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalDeps">Ver en pantalla completa</button>
          </div>
          <div class="diagram-card">
            <h3>Mappings y rutas</h3>
            <pre class="mermaid">sequenceDiagram
  participant U as Usuario
  participant C as Controlador
  participant V as Vista
  U->>C: GET /recursos
  C->>V: render lista.html
  U->>C: GET /recursos/nuevo
  C->>V: render formulario.html
  U->>C: POST /recursos
  C->>C: save(recurso)
  C-->>U: redirect /recursos
            </pre>
            <p class="small-muted">Explica como las rutas GET/POST se traducen en pantallas y guardado.</p>
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalRoutes">Ver en pantalla completa</button>
          </div>
          <div class="diagram-card">
            <h3>Estructura de la app</h3>
            <pre class="mermaid">flowchart TB
  root[src/main]
  root --> java[java/...]
  java --> controller[controlador/]
  java --> model[modelo/]
  java --> repository[repositorio/]
  root --> resources[resources/]
  resources --> templates[templates/recursos]
  resources --> static[static/css]
            </pre>
            <p class="small-muted">Ubica cada archivo segun su responsabilidad dentro de MVC.</p>
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalStructure">Ver en pantalla completa</button>
          </div>
          <div class="diagram-card">
            <h3>Stack moderno vs nuestro stack</h3>
            <pre class="mermaid">flowchart LR
  subgraph Moderno[App moderna]
    FE[SPA/SSR] --> API[REST/GraphQL]
    API --> DBM[(BD)]
  end
  subgraph Curso[Nuestro stack]
    View[Thymeleaf] --> Ctl[Spring MVC]
    Ctl --> Repo[Spring Data JPA]
    Repo --> DBH[(BD H2)]
  end
            </pre>
            <p class="small-muted">Compara un enfoque en capas con el stack didactico del curso.</p>
            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalStack">Ver en pantalla completa</button>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="app-real">
      <div class="container">
        <div class="section-title">
          <h2>Ejemplo real en un stack similar</h2>
          <p>Referencia cercana a nuestro enfoque para entender similitudes y diferencias.</p>
        </div>
        <div class="info-card">
          <h3>Spring PetClinic (aplicacion de ejemplo oficial)</h3>
          <p class="small-muted">Es una app demo de Spring que usa MVC, vistas del lado del servidor y base de datos.</p>
          <div class="row g-3">
            <div class="col-md-6">
              <h4 class="h6">Similitudes</h4>
              <ul>
                <li>Controladores con rutas claras.</li>
                <li>Modelo + repositorio para datos.</li>
                <li>Vistas renderizadas por el servidor.</li>
              </ul>
            </div>
            <div class="col-md-6">
              <h4 class="h6">Diferencias</h4>
              <ul>
                <li>PetClinic usa BD completa (no H2 en archivo).</li>
                <li>Tiene mas entidades y reglas de negocio.</li>
                <li>Incluye validaciones mas avanzadas.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="quiz">
      <div class="container">
        <div class="section-title">
          <h2>Quiz rapido</h2>
          <p>Responde y compara con la solucion al final.</p>
        </div>
        <div class="quiz-card">
          <ol>
            <li>
              ¿Que ruta muestra el listado?
              <div class="quiz-options">
                <label><input type="radio" name="q1" /> GET /recursos</label>
                <label><input type="radio" name="q1" /> POST /recursos</label>
              </div>
            </li>
            <li>
              ¿Que carpeta contiene las vistas?
              <div class="quiz-options">
                <label><input type="radio" name="q2" /> templates/ (plantillas)</label>
                <label><input type="radio" name="q2" /> repositorio/</label>
              </div>
            </li>
            <li>
              ¿Que anotacion recibe datos del formulario?
              <div class="quiz-options">
                <label><input type="radio" name="q3" /> @ModelAttribute</label>
                <label><input type="radio" name="q3" /> @PathVariable</label>
              </div>
            </li>
            <li>
              ¿Que dependencia permite renderizar HTML?
              <div class="quiz-options">
                <label><input type="radio" name="q4" /> Thymeleaf</label>
                <label><input type="radio" name="q4" /> H2</label>
              </div>
            </li>
          </ol>
          <details class="quiz-answer">
            <summary>Ver respuestas</summary>
            <div class="small-muted mt-2">
              1) GET /recursos<br />
              2) templates/ (plantillas)<br />
              3) @ModelAttribute<br />
              4) Thymeleaf
            </div>
          </details>
        </div>

        <div class="callout warning mt-3">
          <div class="fw-semibold">Errores comunes (para evitar)</div>
          <div class="small-muted mt-2">
            Confundir GET con POST, guardar HTML en una carpeta distinta a templates (plantillas), olvidar redirect y dejar el formulario re-enviarse.
          </div>
        </div>
      </div>
    </section>

    <section class="section section-alt" id="bolson">
      <div class="container">
        <div class="section-title">
          <h2>El Bolson Spring (0 a 100)</h2>
          <p>Recordatorio completo de lo necesario para correr la app hasta esta semana.</p>
        </div>

        <div class="info-card mb-3">
          <h3>1) Crear proyecto con Spring Initializr</h3>
          <ul>
            <li>Proyecto: Maven</li>
            <li>Lenguaje: Java</li>
            <li>Spring Boot: estable (recomendada)</li>
            <li>Empaquetado: Jar</li>
            <li>Java: 17</li>
            <li>Dependencias: Spring Web, Thymeleaf, Spring Data JPA, BD H2</li>
          </ul>
        </div>

        <div class="info-card mb-3">
          <h3>2) Estructura minima del proyecto</h3>
          <pre><code class="language-bash">src/main/java/.../
  controlador/
  modelo/
  repositorio/

src/main/resources/
  templates/recursos/
    lista.html
    formulario.html
  static/css/
    estilos.css

src/main/resources/application.properties</code></pre>
        </div>

        <div class="info-card mb-3">
          <h3>3) Comandos (PowerShell)</h3>
          <pre><code class="language-powershell"><span class="code-hotspot" data-tippy-content="Entra a la carpeta del proyecto."># Entrar a la carpeta del proyecto</span>
<span class="code-hotspot" data-tippy-content="Ruta donde esta tu proyecto.">cd ruta\a\tu\proyecto</span>

<span class="code-hotspot" data-tippy-content="Confirma que Java esta instalado."># Verificar Java</span>
<span class="code-hotspot" data-tippy-content="Version de Java.">java -version</span>

<span class="code-hotspot" data-tippy-content="Limpia la carpeta target."># Limpiar</span>
<span class="code-hotspot" data-tippy-content="Ejecuta limpieza de Maven.">./mvnw.cmd clean</span>

<span class="code-hotspot" data-tippy-content="Compila el proyecto."># Compilar</span>
<span class="code-hotspot" data-tippy-content="Genera el jar.">./mvnw.cmd package</span>

<span class="code-hotspot" data-tippy-content="Levanta el servidor."># Correr la app</span>
<span class="code-hotspot" data-tippy-content="Inicia Spring Boot.">./mvnw.cmd spring-boot:run</span>

<span class="code-hotspot" data-tippy-content="Arranca con mas detalle en logs."># Correr con debug</span>
<span class="code-hotspot" data-tippy-content="Activa debug.">./mvnw.cmd spring-boot:run -Dspring-boot.run.arguments="--debug"</span></code></pre>
    <p class="small-muted">Nota: en PowerShell tambien puedes usar <strong>.\mvnw.cmd</strong> si tu sistema no reconoce <strong>./</strong>.</p>
        </div>

        <div class="info-card mb-3">
          <h3>4) Rutas locales (localhost)</h3>
          <ul>
            <li><span class="code-hotspot" data-tippy-content="Muestra la lista de recursos.">Listado:</span> <strong>http://localhost:8080/recursos</strong></li>
            <li><span class="code-hotspot" data-tippy-content="Abre el formulario para crear.">Formulario:</span> <strong>http://localhost:8080/recursos/nuevo</strong></li>
            <li><span class="code-hotspot" data-tippy-content="Acceso a la consola de la base.">Consola H2:</span> <strong>http://localhost:8080/h2-console</strong></li>
          </ul>
        </div>

        <div class="info-card mb-3">
          <h3>4.1) Datos para consola H2</h3>
          <pre><code class="language-bash"><span class="code-hotspot" data-tippy-content="Debe coincidir con application.properties.">JDBC URL: jdbc:h2:file:./data/semana4db</span>
<span class="code-hotspot" data-tippy-content="Usuario por defecto.">User: sa</span>
<span class="code-hotspot" data-tippy-content="Password en blanco.">Password: (vacia)</span></code></pre>
          <p class="small-muted">Si el JDBC URL no coincide, veras una base vacia.</p>
        </div>

        <div class="info-card">
          <h3>5) Lista rapida</h3>
          <ul>
            <li><span class="code-hotspot" data-tippy-content="Si hay 404, revisa el @RequestMapping.">Controlador responde rutas sin 404.</span></li>
            <li><span class="code-hotspot" data-tippy-content="Plantillas deben estar en resources/templates.">Plantillas existen en la ruta correcta.</span></li>
            <li><span class="code-hotspot" data-tippy-content="POST guarda y regresa al listado.">Formulario guarda y redirige.</span></li>
            <li><span class="code-hotspot" data-tippy-content="JDBC URL debe coincidir.">Consola H2 conecta con el JDBC correcto.</span></li>
          </ul>
        </div>
      </div>
    </section>

    <section class="section" id="hotspots">
      <div class="container">
        <div class="section-title">
          <h2>Hotspots de archivos</h2>
          <p>Pasa el cursor para ver para que sirve cada archivo del flujo MVC.</p>
        </div>
        <div class="hotspot-row">
          <span class="hotspot" data-tippy-content="Controlador: define rutas y decide que vista mostrar."></span>
          <span class="hotspot-label">controlador/RecursoDidacticoControlador.java</span>
        </div>
        <div class="hotspot-row">
          <span class="hotspot" data-tippy-content="Modelo: estructura de datos que se guarda en la BD."></span>
          <span class="hotspot-label">modelo/RecursoDidactico.java</span>
        </div>
        <div class="hotspot-row">
          <span class="hotspot" data-tippy-content="Repositorio: metodos para guardar, listar y borrar."></span>
          <span class="hotspot-label">repositorio/RecursoDidacticoRepositorio.java</span>
        </div>
        <div class="hotspot-row">
          <span class="hotspot" data-tippy-content="Plantillas (templates): HTML que ve el usuario."></span>
          <span class="hotspot-label">templates/recursos/lista.html</span>
        </div>
        <div class="hotspot-row">
          <span class="hotspot" data-tippy-content="Plantillas (templates): formulario conectado con th:field."></span>
          <span class="hotspot-label">templates/recursos/formulario.html</span>
        </div>
        <div class="hotspot-row">
          <span class="hotspot" data-tippy-content="Configuracion: define BD, JPA y consola."></span>
          <span class="hotspot-label">resources/application.properties</span>
        </div>
      </div>
    </section>

    <section class="section section-alt" id="checklist">
      <div class="container">
        <div class="section-title">
          <h2>Checklist de aprendizaje</h2>
          <p>Usa esta lista para verificar que el flujo quedo claro.</p>
        </div>
        <div class="row g-3">
          <div class="col-md-6">
            <div class="info-card">
              <h3>Antes de codificar</h3>
              <ol>
                <li><span class="code-hotspot" data-tippy-content="Ejemplo: /recursos muestra el listado.">Puede explicar que es una ruta con un ejemplo real.</span></li>
                <li><span class="code-hotspot" data-tippy-content="Plantillas viven en resources/templates.">Sabe donde viven las vistas (plantillas).</span></li>
                <li><span class="code-hotspot" data-tippy-content="Controladores viven en src/main/java/.../controlador.">Sabe donde vive el Controlador.</span></li>
              </ol>
            </div>
          </div>
          <div class="col-md-6">
            <div class="info-card">
              <h3>Despues de codificar</h3>
              <ol>
                <li><span class="code-hotspot" data-tippy-content="GET /recursos carga lista.html.">GET muestra la lista sin error.</span></li>
                <li><span class="code-hotspot" data-tippy-content="GET /recursos/nuevo carga formulario.html.">GET /nuevo muestra formulario.</span></li>
                <li><span class="code-hotspot" data-tippy-content="POST /recursos guarda y redirige.">POST guarda y redirige.</span></li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>Material de apoyo Semana 5 - Rutas y Controladores. Hecho para docencia TIC.</p>
    </div>
  </footer>

  <div class="modal fade" id="codeHelpModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Explicacion de linea</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p id="codeHelpText" class="mb-0"></p>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade diagram-modal" id="modalMvc" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">MVC y flujo</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
            <p class="small-muted">El usuario solicita una pagina, el Controlador decide que vista devolver, el Repositorio obtiene datos y la vista se renderiza.</p>
            <pre class="mermaid">flowchart LR
          A[Usuario] --> B[Vista HTML]
          B --> C[Controlador]
          C --> D[Repositorio]
          D --> E[(BD H2)]
          E --> D --> C --> B
          </pre>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade diagram-modal" id="modalDeps" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Imports y dependencias</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
            <p class="small-muted">Cada dependencia habilita una capacidad: rutas, vistas, acceso a datos y BD.</p>
          <pre class="mermaid">flowchart TB
          Web[Spring Web] --> Controlador
  Thymeleaf[Thymeleaf] --> Vista
          JPA[Spring Data JPA] --> Repositorio
  H2[BD H2] --> DB[(BD)]
          Controlador --> Vista
          Controlador --> Repositorio
          </pre>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade diagram-modal" id="modalRoutes" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Mappings y rutas</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p class="small-muted">GET muestra vistas. POST guarda datos y redirige para evitar reenvio.</p>
          <pre class="mermaid">sequenceDiagram
  participant U as Usuario
          participant C as Controlador
  participant V as Vista
  U->>C: GET /recursos
          C->>V: render lista.html
          U->>C: GET /recursos/nuevo
          C->>V: render formulario.html
  U->>C: POST /recursos
  C->>C: save(recurso)
  C-->>U: redirect /recursos
          </pre>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade diagram-modal" id="modalStructure" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Estructura de la app</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p class="small-muted">Cada carpeta refleja una responsabilidad. Esto ayuda a encontrar errores rapido.</p>
          <pre class="mermaid">flowchart TB
  root[src/main]
  root --> java[java/...]
          java --> controller[controlador/]
          java --> model[modelo/]
          java --> repository[repositorio/]
  root --> resources[resources/]
  resources --> templates[templates/recursos]
  resources --> static[static/css]
          </pre>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade diagram-modal" id="modalStack" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Stack moderno vs nuestro stack</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p class="small-muted">La app moderna separa frontend y backend. En el curso usamos vistas en el servidor para entender el flujo sin complejidad extra.</p>
          <pre class="mermaid">flowchart LR
  subgraph Moderno[App moderna]
    FE[SPA/SSR] --> API[REST/GraphQL]
    API --> DBM[(BD)]
  end
  subgraph Curso[Nuestro stack]
    View[Thymeleaf] --> Ctl[Spring MVC]
    Ctl --> Repo[Spring Data JPA]
    Repo --> DBH[(BD H2)]
  end
          </pre>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <div class="modal fade" id="modalEstructura" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Estructura de carpetas</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p><strong>Original:</strong> estructura basica definida.</p>
          <p><strong>Idea clave:</strong> cada carpeta responde a una pregunta.</p>
          <ul>
            <li><strong>controlador:</strong> que ruta atiende y que vista devuelve.</li>
            <li><strong>modelo:</strong> que datos guardamos.</li>
            <li><strong>repositorio:</strong> como hablamos con la base de datos.</li>
            <li><strong>templates (plantillas):</strong> lo que ve el usuario.</li>
            <li><strong>static:</strong> CSS y recursos visuales.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalProperties" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">application.properties</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>La version basica funciona, pero la version extendida ayuda a depurar y entender la BD.</p>
          <pre><code class="language-ini"><span class="code-hotspot" data-tippy-content="Ruta del archivo de la base de datos.">spring.datasource.url=jdbc:h2:file:./data/semana4db</span>
      <span class="code-hotspot" data-tippy-content="Driver de H2.">spring.datasource.driverClassName=org.h2.Driver</span>
      <span class="code-hotspot" data-tippy-content="Usuario por defecto.">spring.datasource.username=sa</span>
      <span class="code-hotspot" data-tippy-content="Password vacia.">spring.datasource.password=</span>

      <span class="code-hotspot" data-tippy-content="Actualiza la tabla automaticamente.">spring.jpa.hibernate.ddl-auto=update</span>
      <span class="code-hotspot" data-tippy-content="Muestra SQL en consola.">spring.jpa.show-sql=true</span>
      <span class="code-hotspot" data-tippy-content="Formatea el SQL.">spring.jpa.properties.hibernate.format_sql=true</span>

      <span class="code-hotspot" data-tippy-content="Habilita la consola H2.">spring.h2.console.enabled=true</span>
      <span class="code-hotspot" data-tippy-content="Ruta de la consola.">spring.h2.console.path=/h2-console</span>
      <span class="code-hotspot" data-tippy-content="Puerto del servidor.">server.port=8080</span></code></pre>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalEntidad" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Entidad (Modelo)</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>El material original deja los getters/setters como comentario. Sin ellos, el formulario no puede mapear datos.</p>
          <pre><code class="language-java"><span class="code-hotspot" data-tippy-content="Paquete donde vive la entidad.">package modelo;</span>
<span class="code-hotspot" data-tippy-content="Marca la clase como entidad JPA.">@Entity</span>
<span class="code-hotspot" data-tippy-content="Nombre de la tabla.">@Table(name = "recursos_didacticos")</span>
public class RecursoDidactico {
  <span class="code-hotspot" data-tippy-content="Llave primaria.">@Id</span>
  <span class="code-hotspot" data-tippy-content="Auto incremento del id.">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
  private Long id;
  private String titulo;
  private String tipo;
  private String url;
  private Boolean disponible;

  <span class="code-hotspot" data-tippy-content="Constructor vacio requerido por JPA.">public RecursoDidactico() {}</span>

  public RecursoDidactico(String titulo, String tipo, String url, Boolean disponible) {
    this.titulo = titulo;
    this.tipo = tipo;
    this.url = url;
    this.disponible = disponible;
  }

  // getters y setters completos
}</code></pre>
          <p><strong>Regla clave:</strong> si falta un getter o setter, el formulario falla silenciosamente.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalRepo" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Repositorio</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>La interfaz es corta pero poderosa: Spring Data JPA genera metodos automaticamente.</p>
          <pre><code class="language-java"><span class="code-hotspot" data-tippy-content="Paquete donde vive el repositorio.">package repositorio;</span>
<span class="code-hotspot" data-tippy-content="Marca el repositorio como componente.">@Repository</span>
public interface RecursoDidacticoRepositorio extends JpaRepository&lt;RecursoDidactico, Long&gt; {
  // save, findAll, findById, deleteById
}</code></pre>
          <p><strong>Nota:</strong> Spring Data JPA genera automaticamente los metodos comunes.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalController" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Controlador</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>El controlador decide que vista mostrar y cuando guardar.</p>
          <pre><code class="language-java"><span class="code-hotspot" data-tippy-content="Paquete del controlador.">package controlador;</span>
<span class="code-hotspot" data-tippy-content="Ruta GET para listar.">@GetMapping</span>
public String list(Model model) {
  <span class="code-hotspot" data-tippy-content="Envia la lista a la vista.">model.addAttribute("recursos", repo.findAll());</span>
  <span class="code-hotspot" data-tippy-content="Nombre de la vista.">return "recursos/lista";</span>
}

<span class="code-hotspot" data-tippy-content="Ruta GET para formulario.">@GetMapping("/nuevo")</span>
public String form(Model model) {
  <span class="code-hotspot" data-tippy-content="Envia un objeto vacio al form.">model.addAttribute("recurso", new RecursoDidactico());</span>
  return "recursos/formulario";
}

<span class="code-hotspot" data-tippy-content="Ruta POST para guardar.">@PostMapping</span>
public String create(@ModelAttribute RecursoDidactico recurso) {
  if (recurso.getDisponible() == null) {
    recurso.setDisponible(false);
  }
  <span class="code-hotspot" data-tippy-content="Guarda en la base de datos.">repo.save(recurso);</span>
  <span class="code-hotspot" data-tippy-content="Redirige para evitar reenvio.">return "redirect:/recursos";</span>
}</code></pre>
          <p><strong>Clave:</strong> cada metodo responde a una ruta y regresa una vista o un redirect.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalVistas" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Vistas y CSS</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>Las vistas son el 70% del trabajo visible. Sin HTML completo, el CRUD no se ve.</p>
          <ul>
            <li><strong>lista.html:</strong> tabla con `th:each` y botones de accion.</li>
            <li><strong>formulario.html:</strong> formulario con `th:field` y validacion HTML5.</li>
            <li><strong>estilos.css:</strong> detalles visuales que mejoran la lectura.</li>
          </ul>
          <p><strong>Nota:</strong> primero funcional, luego bonito.</p>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/highlight.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6.3.7/dist/tippy-bundle.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    if (window.hljs) {
      hljs.highlightAll();
    }
    if (window.tippy) {
      tippy('[data-tippy-content]', { theme: 'light', maxWidth: 280 });
    }
    mermaid.initialize({ startOnLoad: true });
    document.querySelectorAll('.diagram-modal').forEach(function(modal) {
      modal.addEventListener('shown.bs.modal', function() {
        mermaid.init(undefined, modal.querySelectorAll('.mermaid'));
      });
    });

    const codeHelpText = document.getElementById('codeHelpText');
    const codeHelpModal = document.getElementById('codeHelpModal');
    const openHelp = (el) => {
      if (!codeHelpText || !codeHelpModal) {
        return;
      }
      const text = el.getAttribute('data-tippy-content') || 'Sin descripcion.';
      codeHelpText.textContent = text;
      const modal = new bootstrap.Modal(codeHelpModal);
      modal.show();
    };

    document.querySelectorAll('.code-hotspot, .hotspot').forEach((el) => {
      el.addEventListener('click', (event) => {
        event.preventDefault();
        event.stopPropagation();
        openHelp(el);
      });
    });
  </script>
</body>
</html>
